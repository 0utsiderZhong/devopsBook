# 第六章：分布式系统共识概论

微服务架构设计有个服务无状态（stateless）的原则，服务无状态不依赖会话数据，能更容易的横向扩展。无状态的服务如果需要存储数据时，就往中间件转移。比如持久化的数据往关系数据库存储，缓存的数据往 Redis 存储，消息的接收往 MQ 转移等等。这些存储核心数据的节点如何保证高可用呢？常见的方案是将多个成员采用副本的形式组成一个集群，集群副本的方案要求多个成员之间保持数据对齐，才能提供正确的服务，当单个或少数成员发生故障时，在外部看来，集群系统还是整体一致性的状态。实现这一过程，能让分布式集群即使是在部分节点故障、网络延时、网络分割的情况下，仍能最终表现出整体一致的过程，就被称为各个节点的协商共识。


开源分布式锁组件 Google Chubby 的作者 Mike Burrows 说过：“这个世界上只有一种共识协议，那就是 Paxos，其他所有的共识算法都是 Paxos 的退化版本。”。Paxos 算法虽然重要，但是也因算法复杂而著名，这一节我们就知难而上，从 Paxos 入手，去掉无关干扰，直达分布式系统的问题本质。