# CAP

首先 CAP 是学术描述性的理论，它并不解决工程问题。

CAP理论告诉我们：一个分布式系统不可能同时满足一致性（C：Consistency）、可用性（A: Availability）和分区容错性（P：Partition tolerance）这三个基本需求，最多只能同时满足其中两项。

<div  align="center">
	<img src="../assets/cap.png" width = "250"  align=center />
</div>

## 一致性

一致性是指数据在多个副本之间是否能够保持一致的特性。

CAP 定理是在说在某种状态下的选择，和实际工程的理论是有差别的，事务中的一致性包含了实际工程对状态的后续处理。但是 CAP 定理并不涉及到状态的后续处理，对于这些问题，后续出现了 BASE 理论。

## 可用性

可用性是指系统提供的服务必须还一直处于可用的状态，对于用户的每一个操作请求总是能够在有限的时间内返回结果。这里需要注意“有限时间内”和“返回结果”。如果时间处理的延时以及结果匹配性存在异常，那么我们认为系统是不可用的。

## 分区容错性

分布式的存储系统会有很多的节点，这些节点都是通过网络进行通信。而网络是不可靠的，当节点和节点之间的通信出现了问题，此时，就称当前的分布式存储系统出现了分区。

分区容错性约束了一个分布式系统需要具有如下特征：分布式系统在遇到任何网络分区故障时，仍然需要能够保证对外提供满足一致性和可用性的服务，除非整个网络环境发生故障。


## 小结

对于一个分布式系统而言，因为网络必然会出现异常情况，一旦发生分区错误，整个分布式系统就完全无法使用，分区容错性也就成了必然要面对和解决的问题，因此系统架构师往往需要把精力花在如何根据业务特点在C(一致性)和A（可用性）之间寻求平衡。

而根据一致性和可用性的选择不同，开源的分布式系统往往又被分为 CP 系统和 AP 系统。例如 CP 系统 Zookeeper，任何时刻对 ZooKeeper 的访问请求保证能得到一致的数据结果，而另外的 AP 系统 Eureka，则保证 A，当分区发生故障时，保证可用性但无法保证数据一致性。