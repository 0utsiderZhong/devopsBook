# 2.8.3 QUIC 实践

QUIC 行不行，得看一下线上环境的实践结果。

对 HTTP/1.1、HTTP/2、HTTP/3 等各版本进行可用性测试，本文将测试数据分享，以供读者参考

1. 各协议耗时表现

根据用户网络状态分级，进行综合性比较, 在同等网络环境条件下 HTTP/3 或 H3-29 约有一倍效率提升（耗时单位 ms）。

<div  align="center">
	<img src="../assets/quic-1.png" width = "660"  align=center />
	<p>图2-18 协议耗时表现</p>
</div>


2. 各协议成功率表现

<div  align="center">
	<img src="../assets/quic-3.png" width = "660"  align=center />
	<p>图2-19 协议成功率表现</p>
</div>

继续看网络请求成功率的对比，综合来看 HTTP3 或 H3-29 的失败率更高。

3. 小结

无论是在客户端还是服务端，QUIC 协议的集成并非一件易事，下面让我们来看看客户端和服务端在集成 QUIC 时需要考虑的问题：

- 客户端的问题
	- 应用适配成本和收益之间的权衡。
	- 过渡期可能还需要新旧网络库都存在，方便降级容错，增加应用体积。

- 服务端的问题
	- 网络事件模型需要适配 QUIC 协议栈做调整，同时还要考虑和 TCP 的兼容。
	- 后端架构面临调整，例如 4 层负载均衡是否支持 QUIC？ HTTP/3 的 QUIC 流量如何换成 HTTP/1 转给后端服务器。
	- 需要考虑到多 Region、多节点之间的 QUIC 连接复用和连接迁移。
	- 服务端 QUIC 流量的能耗比，如何做到和 TCP 一样的能耗性能。

虽然 HTTP/3 已经被标准化，不过还是得面对现实，HTTP/3 大规模应用还需给一点时间。