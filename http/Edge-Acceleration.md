# 2.6.3 使用动态加速服务改善链路

如果我们提供一个全球化的网络产品，用户来自于世界各地，这种情况下我们该如何改善网络质量呢？除了前面我们提及的多地同服技术外，我们还可以使用一些商业化的 DSA（Dynamic Site Accelerator，动态加速服务）服务改善网络质量。

DSA 主要是通过大量的边缘节点，结合链路优化算法及协议层优化，对 TCP/UD P 四层之上的动态内容进行最优传输路径快速分发的服务，这种加速服务可以改善跨运营商、跨国、网络不稳定等因素导致的响应慢、丢包、服务不稳定等问题。


动态加速服务利用边缘节点组成的虚拟网络，在 L7层代理转请求发改变路由路径来实现链路优先，流程大致如下。

- 源站提供一个 20KB 用于探测的资源
- 服务商会在源站周边选择一批候选边缘节点。
- 候选边缘节点对测试资源进行下载测试，多个候选边缘节点多路探索后，根据丢包率、RTT、hops数等选择最佳的路由线路。

<div  align="center">
	<img src="../assets/direct-connect-wecome-v1.1.jpg" width = "550"  align=center />
	<p>图：Akamai 加速服务</p>
</div>

除了路由优化外，根据前面 TCP 优化策略，CDN 服务商也会有连接、传输等相关的策略调整。在应用层，像 TLS1.3、ECC 证书、QUIC 协议等等对服务有提升的技术都有尝试落地。

## 1. 动态加速优化效果

目前主流的 CDN 服务商都提供加速服务，例如 Akamai、Fastly、Cloudfront、Azure 等等。这些服务商在全球各区域部署了近几十万台边缘设备，提供了可靠、稳定的加速服务。

笔者使用 Akamai 的加速服务，从抽样的数据看，整体连接速度提升了 30% 右，我将测试数据整理成表格，供读者参考。对比加速与直连的数据，香港直连平均 0.57s，Akamai 加速 0.41s，使用加速服务提速 39% 。

区域|直连|Akamai加速|提升
:---|:--:|:--:|:--
Bangkok|0.58s|0.44|31%
jakarta|0.57s|0.44|31%
Kuala Lumpur|0.52s|0.38|36%
Taibei|0.51s|0.40|37%
Hanoi Bac Mai|0.54s|0.41|30%
Singapore|0.58s|0.39|48%
Hong Kong|0.38s|0.24|58%
Tokyo|0.60s|0.45s|32%
Surabaya|0.67s|0.52s|29%
Manila|0.46s|0.34s|36%


