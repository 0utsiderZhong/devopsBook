# Anycast 技术

Anycast 是一种网络寻址和路由方法，可以将传入请求路由到各种不同的位置或“节点”。 

BGP AnyCast就是利用一个（或多个）AS号码在不同的地区广播相同的一个IP段。即不同地区若干个AS号广播同一个IP（段），AnyCast利用BGP的寻路原则，短的AS PATH会选成最优路径（BGP寻路原则之一），从而优化了访问速度。

即可多个不同服务器使用了相同的IP地址（该地址即这一组主机的共享单播地址）的一种技术。当发送方发送报文给这个共享单播地址时，报文会根据路由协议路由到这一组主机中离发送方最近的一台，所以这个技术也可以用来做负载均衡。

## AnyCast应用场景

AnyCast主要应用于大范围的DNS部署，CDN数据缓存，数据中心等。

疑惑一：在AnyCast网络中多个主机用同一个IP，这岂不是IP地址冲突了？

解惑：首先，每一个节点主机处在不同的地理位置，相互之间不在同一个广播域内。所以把所有主机配置成相同的IP地址并不会引起我们日常所见的IP地址冲突；

其次，在仅仅配置相同IP之外，还需要借助BGP协议进行地址宣告，通过BGP，各个站点向Internet宣告相同的AnyCast IP地址。

疑惑二：具有多条到达目的的路径，且具有相同Anycast IP地址的Prefix，数据包如何做到就近路由选址的呢？。

解惑：当用户的DNS（数据）请求到达运营商的宽带路由器以后，运营商的路由器会根据BGP的选路原则选择到达目的的最优路径。在用户宽带运营商和DNS服务器Internet运营商相同的情况下，最终会以IGP metric为关键因素来决定哪个DNS服务器给用户提供服务。而IGP的 Metric某种程度上就是物理距离的代表，从而实现就近原则。